{
  "suite": "Lab 1a Complete Verification",
  "timestamp": "2026-02-02T20:43:31Z",
  "region": "us-east-1",
  "instance_id": "i-0d24fcd824ddbdd0c",
  "secret_id": "lab1a/rds/mysql",
  "db_id": "chrisbarm-rds01",
  "tests": {
    "gate_secrets_and_role": {
      "test": "gate_secrets_and_role",
      "timestamp": "2026-02-02T20:43:16Z",
      "passed": true,
      "errors": [],
      "checks": {
        "ec2_instance_role_attached": {
          "status": "pass",
          "details": "Instance profile: arn:aws:iam::198547498722:instance-profile/chrisbarm-instance-profile01"
        },
        "iam_role_has_secrets_policy": {
          "status": "pass",
          "details": "Policies: secrets_policy\tCloudWatchAgentServerPolicy\tAmazonSSMManagedInstanceCore"
        },
        "secret_exists": {
          "status": "pass",
          "details": "Secret ARN: arn:aws:secretsmanager:us-east-1:198547498722:secret:lab1a/rds/mysql-0ad1ux"
        },
        "secret_has_credentials": {
          "status": "pass",
          "details": "Contains: username, password, host, port, dbname"
        }
      }
    },
    "gate_network_db": {
      "test": "gate_network_db",
      "timestamp": "2026-02-02T20:43:24Z",
      "passed": true,
      "errors": [],
      "checks": {
        "rds_instance_exists": {
          "status": "pass",
          "details": "DB ID: chrisbarm-rds01"
        },
        "rds_not_publicly_accessible": {
          "status": "pass",
          "details": "PubliclyAccessible: false"
        },
        "rds_has_security_group": {
          "status": "pass",
          "details": "Security Groups: sg-00c4a42158a0e217e\r "
        },
        "vpcs_same": {
          "status": "pass",
          "details": "Both in VPC: vpc-02709f3087724afb0"
        },
        "rds_sg_to_sg_rule_exists": {
          "status": "pass",
          "details": "EC2 SG sg-09ab009d3d15bf0b1 has ingress to RDS SG sg-00c4a42158a0e217e"
        },
        "rds_port_identified": {
          "status": "pass",
          "details": "Port: 3306"
        },
        "rds_port_in_sg_rule": {
          "status": "pass",
          "details": "Port 3306 in SG ingress rule"
        }
      }
    }
  },
  "overall_passed": true,
  "exit_code": 0
}
